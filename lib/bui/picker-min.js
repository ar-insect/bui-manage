/**
 * @fileOverview Picker\u7684\u5165\u53e3
 * @author dxq613@gmail.com
 * @ignore
 */define("bui/picker",["bui/common","bui/picker/mixin","bui/picker/picker","bui/picker/listpicker"],function(e){var t=e("bui/common"),n=t.namespace("Picker");return t.mix(n,{Mixin:e("bui/picker/mixin"),Picker:e("bui/picker/picker"),ListPicker:e("bui/picker/listpicker")}),n}),define("bui/picker/mixin",function(e){var t=function(){};return t.ATTRS={innerControl:{getter:function(){return this.get("children")[0]}},triggerEvent:{value:"click"},autoSetValue:{value:!0},changeEvent:{value:"selectedchange"},autoHide:{value:!0},hideEvent:{value:"itemclick"},textField:{},align:{value:{points:["bl","tl"],offset:[0,0]}},valueField:{}},t.prototype={__bindUI:function(){var e=this,t=e.get("hideEvent"),n=$(e.get("trigger"));e.on("show",function(t){e.get("isInit")||e._initControl();if(e.get("autoSetValue")){var n=e.get("valueField")||e.get("textField")||e.get("curTrigger"),r=$(n).val();e.setSelectedValue(r)}})},_initControl:function(){var e=this;if(e.get("isInit"))return;if(!e.get("innerControl")){var t=e.createControl();e.get("children").push(t)}e.initControlEvent(),e.set("isInit",!0)},initControl:function(){this._initControl()},createControl:function(){},initControlEvent:function(){var e=this,t=e.get("innerControl"),n=$(e.get("trigger")),r=e.get("hideEvent");t.on(e.get("changeEvent"),function(t){var r=e.get("curTrigger"),i=e.get("textField")||r||n,s=e.get("valueField"),o=e.getSelectedValue(),u=!1;if(i){var a=e.getSelectedText(),f=$(i).val();a!=f&&($(i).val(a),u=!0,$(i).trigger("change"))}if(s&&e.get("autoSetValue")){var l=$(s).val();s!=l&&($(s).val(o),u=!0,$(s).trigger("change"))}u&&e.onChange(a,o,t)}),r&&t.on(e.get("hideEvent"),function(){var t=e.get("curTrigger");try{t&&t.focus()}catch(n){BUI.log(n)}e.hide()})},setSelectedValue:function(e){},getSelectedValue:function(){},getSelectedText:function(){},focus:function(){this.get("innerControl").focus()},onChange:function(e,t,n){var r=this,i=r.get("curTrigger");r.fire("selectedchange",{value:t,text:e,curTrigger:i})},handleNavEsc:function(e){this.hide()},_uiSetValueField:function(e){var t=this;e!=null&&e!==""&&t.get("autoSetValue")&&t.setSelectedValue($(e).val())},_getTextField:function(){var e=this;return e.get("textField")||e.get("curTrigger")}},t}),define("bui/picker/picker",["bui/overlay","bui/picker/mixin"],function(e){var t=e("bui/overlay").Overlay,n=e("bui/picker/mixin"),r=t.extend([n],{},{ATTRS:{}},{xclass:"picker"});return r}),define("bui/picker/listpicker",["bui/picker/picker","bui/list"],function(e){var t=e("bui/list"),n=e("bui/picker/picker"),r=n.extend({initializer:function(){var e=this,t=e.get("children"),n=e.get("list");n||t.push({})},setSelectedValue:function(e){e=e?e.toString():"",this.get("isInit")||this._initControl();var t=this,n=t.get("list"),r=t.getSelectedValue();e!==r&&n.getCount()&&(n.get("multipleSelect")&&n.clearSelection(),n.setSelectionByField(e.split(",")))},onChange:function(e,t,n){var r=this,i=r.get("curTrigger");r.fire("selectedchange",{value:t,text:e,curTrigger:i,item:n.item})},getSelectedValue:function(){return this.get("isInit")||this._initControl(),this.get("list").getSelectionValues().join(",")},getSelectedText:function(){return this.get("isInit")||this._initControl(),this.get("list").getSelectionText().join(",")}},{ATTRS:{defaultChildClass:{value:"simple-list"},list:{getter:function(){return this.get("children")[0]}}}},{xclass:"list-picker"});return r});
