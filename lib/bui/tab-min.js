/**
 * @fileOverview \u5207\u6362\u6807\u7b7e\u5165\u53e3
 * @ignore
 */define("bui/tab",["bui/common","bui/tab/tab","bui/tab/tabitem","bui/tab/navtabitem","bui/tab/navtab","bui/tab/tabpanel","bui/tab/tabpanelitem"],function(e){var t=e("bui/common"),n=t.namespace("Tab");return t.mix(n,{Tab:e("bui/tab/tab"),TabItem:e("bui/tab/tabitem"),NavTabItem:e("bui/tab/navtabitem"),NavTab:e("bui/tab/navtab"),TabPanel:e("bui/tab/tabpanel"),TabPanelItem:e("bui/tab/tabpanelitem")}),n}),define("bui/tab/panelitem",function(e){var t=function(){};return t.ATTRS={panel:{},panelContent:{},panelVisibleStatus:{value:"selected"},defaultLoaderCfg:{valueFn:function(){var e=this,t=e._getVisibleEvent();return{property:"panelContent",autoLoad:!1,lazyLoad:{event:t},loadMask:{el:e.get("panel")}}}},panelDestroyable:{value:!0}},BUI.augment(t,{__renderUI:function(){this._resetPanelVisible()},__bindUI:function(){var e=this,t=e._getVisibleEvent();e.on(t,function(t){e._setPanelVisible(t.newVal)})},_resetPanelVisible:function(){var e=this,t=e.get("panelVisibleStatus"),n=e.get(t);e._setPanelVisible(n)},_getVisibleEvent:function(){var e=this,t=e.get("panelVisibleStatus");return"after"+BUI.ucfirst(t)+"Change"},_setPanelVisible:function(e){var t=this,n=t.get("panel"),r=e?"show":"hide";n&&$(n)[r]()},__destructor:function(){var e=this,t=e.get("panel");t&&e.get("panelDestroyable")&&$(t).remove()},_setPanelContent:function(e,t){var n=$(e);$(e).html(t)},_uiSetPanelContent:function(e){var t=this,n=t.get("panel");t._setPanelContent(n,e)},_uiSetPanel:function(e){var t=this,n=t.get("panelContent");n&&t._setPanelContent(e,n),t._resetPanelVisible()}}),t}),define("bui/tab/panels",function(e){var t=function(){};return t.ATTRS={panelTpl:{},panelContainer:{},panelCls:{}},BUI.augment(t,{__renderUI:function(){var e=this,t=e.get("children"),n=e._initPanelContainer(),r=e.get("panelCls"),i=r?n.find("."+i):n.children();BUI.each(t,function(t,n){var r=i[n];e._initPanelItem(t,r)})},__bindUI:function(){var e=this;e.on("beforeAddChild",function(t){var n=t.child;e._initPanelItem(n)})},_initPanelContainer:function(){var e=this,t=e.get("panelContainer");return t&&BUI.isString(t)&&(t.indexOf("#")==0?t=$(t):t=e.get("el").find(t),e.setInternal("panelContainer",t)),t},_initPanelItem:function(e,t){var n=this;e.set?e.get("panel")||(t=t||n._getPanel(e.get("userConfig")),e.set("panel",t)):e.panel||(t=t||n._getPanel(e),e.panel=t)},_getPanel:function(e){var t=this,n=t.get("panelContainer"),r=BUI.substitute(t.get("panelTpl"),e);return $(r).appendTo(n)}}),t}),define("bui/tab/navtabitem",["bui/common"],function(e){var t=e("bui/common"),n=t.Component,r="tab-item-title",i="tab-item-close",s="tab-item-inner",o="tab-nav-actived",u="tab-content",a=n.View.extend({renderUI:function(){var e=this,t=e.get("tabContentContainer"),n=e.get("tabContentTpl");if(t){var r=$(n).appendTo(t);e.set("tabContentEl",r)}},_uiSetHref:function(e){this._setHref(e)},_setHref:function(e){var t=this,n=t.get("tabContentEl");e=e||t.get("href"),n&&$("iframe",n).attr("src",e)},resetHref:function(){this._setHref()},_uiSetTitle:function(e){var t=this,n=t.get("el");$("."+r,n).html(e)},_uiSetActived:function(e){var t=this,n=t.get("el");t.setTabContentVisible(e),e?n.addClass(o):n.removeClass(o)},destructor:function(){var e=this,t=e.get("tabContentEl");t&&t.remove()},setTabContentVisible:function(e){var t=this,n=t.get("tabContentEl");n&&(e?n.show():n.hide())}},{ATTRS:{tabContentContainer:{},tabContentEl:{},title:{},href:{}}}),f=n.Controller.extend({createDom:function(){var e=this,t=e.get("parent");t&&e.set("tabContentContainer",t.getTabContentContainer())},bindUI:function(){var e=this,t=e.get("el"),n=e.get("events");t.on("click",function(t){var n=$(t.target);n.hasClass(i)&&e.fire("closing")!==!1&&e.close()})},handleDblClick:function(e){var t=this;t.get("closeable")&&t.fire("closing")!==!1&&t.close(),t.fire("dblclick",{domTarget:e.target,domEvent:e})},handleContextMenu:function(e){e.preventDefault(),this.fire("showmenu",{position:{x:e.pageX,y:e.pageY}})},setTitle:function(e){this.set("title",e)},close:function(){this.fire("closed")},reload:function(){this.get("view").resetHref()},show:function(){var e=this;e.get("el").show(500,function(){e.set("visible",!0)})},hide:function(e){var t=this;this.get("el").hide(500,function(){t.set("visible",!1),e&&e()})},_uiSetActived:function(e){var t=this,n=t.get("parent");n&&e&&n._setItemActived(t)},_uiSetCloseable:function(e){var t=this,n=t.get("el"),r=n.find("."+i);e?r.show():r.hide()}},{ATTRS:{elTagName:{value:"li"},actived:{view:!0,value:!1},closeable:{value:!0},allowTextSelection:{view:!1,value:!1},events:{value:{click:!0,closing:!0,closed:!0,showmenu:!0,afterVisibleChange:!0}},tabContentContainer:{view:!0},tabContentTpl:{view:!0,value:'<div class="'+u+'" style="display:none;"><iframe src="" width="100%" height="100%" frameborder="0"></iframe></div>'},href:{view:!0,value:""},visible:{view:!0,value:!0},title:{view:!0,value:""},tpl:{view:!0,value:'<s class="l"></s><div class="'+s+'">{icon}<span class="'+r+'"></span><s class="'+i+'"></s></div><s class="r"></s>'},xview:{value:a}}},{xclass:"nav-tab-item",priority:0});return f.View=a,f}),define("bui/tab/navtab",["bui/common","bui/menu"],function(e){var t=e("bui/common"),n=e("bui/menu"),r=t.Component,i="tab-nav-list",s="arrow-left",o="arrow-right",u=t.prefix+"tab-force",a="m_close",f=140,l=r.View.extend({renderUI:function(){var e=this,t=e.get("el"),n=null;n=t.find("."+i),e.setInternal("listEl",n)},getContentElement:function(){return this.get("listEl")},getTabContentContainer:function(){return this.get("el").find(".tab-content-container")},_uiSetHeight:function(e){var t=this,n=t.get("el"),r=n.find(".tab-nav-bar"),i=t.getTabContentContainer();e&&i.height(e-r.height()),n.height(e)},_uiSetForceFit:function(e){var t=this,n=t.get("el");e?n.addClass(u):n.removeClass(u)}},{ATTRS:{forceFit:{}}},{xclass:"nav-tab-view",priority:0}),c=r.Controller.extend({addTab:function(e,n){var r=this,i=e.id||t.guid("tab-item"),s=r.get("forceFit"),o=r.getItemById(i);if(o){var u=!1;e.href&&o.get("href")!=e.href&&(o.set("href",e.href),u=!0),r._setItemActived(o),n&&!u&&o.reload()}else e=t.mix({id:i,visible:!1,actived:!0,xclass:"nav-tab-item"},e),o=r.addChild(e),s&&r.forceFit(),o.show(),r._resetItemList();return o},getTabContentContainer:function(){return this.get("view").getTabContentContainer()},bindUI:function(){var e=this,t=e.get("forceFit");t||(e._bindScrollEvent(),e.on("afterVisibleChange",function(t){var n=t.target;n.get("actived")&&e._scrollToItem(n)})),e.on("click",function(t){var n=t.target;n!=e&&(e._setItemActived(n),e.fire("itemclick",{item:n}))}),e.on("closed",function(t){var n=t.target;e._closeItem(n)}),e.on("showmenu",function(t){e._showMenu(t.target,t.position)})},_bindScrollEvent:function(){var e=this,t=e.get("el");t.find(".arrow-left").on("click",function(){t.hasClass(s+"-active")&&e._scrollLeft()}),t.find(".arrow-right").on("click",function(){t.hasClass(o+"-active")&&e._scrllRight()})},_showMenu:function(e,t){var n=this,r=n._getMenu(),i=e.get("closeable"),s;n.set("showMenuItem",e),r.set("xy",[t.x,t.y]),r.show(),s=r.getItem(a),s&&s.set("disabled",!i)},setActived:function(e){var t=this,n=t.getItemById(e);t._setItemActived(n)},getActivedItem:function(){var e=this,n=e.get("children"),r=null;return t.each(n,function(e){if(e.get("actived"))return r=e,!1}),r},getItemById:function(e){var n=this,r=n.get("children"),i=null;return t.each(r,function(t){if(t.get("id")===e)return i=t,!1}),i},_getMenu:function(){var e=this;return e.get("menu")||e._initMenu()},_initMenu:function(){var e=this,t=new n.ContextMenu({children:[{xclass:"context-menu-item",iconCls:"icon icon-refresh",text:"\u5237\u65b0",listeners:{click:function(){var t=e.get("showMenuItem");t&&t.reload()}}},{id:a,xclass:"context-menu-item",iconCls:"icon icon-remove",text:"\u5173\u95ed",listeners:{click:function(){var t=e.get("showMenuItem");t&&t.close()}}},{xclass:"context-menu-item",iconCls:"icon icon-remove-sign",text:"\u5173\u95ed\u5176\u4ed6",listeners:{click:function(){var t=e.get("showMenuItem");t&&e.closeOther(t)}}},{xclass:"context-menu-item",iconCls:"icon icon-remove-sign",text:"\u5173\u95ed\u6240\u6709",listeners:{click:function(){e.closeAll()}}}]});return e.set("menu",t),t},_closeItem:function(e){var t=this,n=t._getIndex(e),r=t.getActivedItem(),i=t.get("preItem")||t._getItemByIndex(n-1),s=t._getItemByIndex(n+1);e.hide(function(){t.removeChild(e,!0),t._resetItemList(),r===e?i?t._setItemActived(i):t._setItemActived(s):t._scrollToItem(r),t.forceFit()})},closeAll:function(){var e=this,n=e.get("children");t.each(n,function(e){e.get("closeable")&&e.close()})},closeOther:function(e){var n=this,r=n.get("children");t.each(r,function(t){e!==t&&t.close()})},_getItemByIndex:function(e){var t=this,n=t.get("children");return n[e]},_getIndex:function(e){var n=this,r=n.get("children");return t.Array.indexOf(e,r)},_resetItemList:function(){if(this.get("forceFit"))return;var e=this,t=e.getContentElement();t.width(e._getTotalWidth())},_getTotalWidth:function(){var e=this,t=e.get("children");return t.length*e.get("itemWidth")},_getForceItemWidth:function(){var e=this,t=e.getContentElement().width(),n=e.get("children"),r=e._getTotalWidth(),i=e.get(i);return r>t&&(i=t/n.length),i},forceFit:function(){var e=this;e._forceItemWidth(e._getForceItemWidth())},_forceItemWidth:function(e){e=e||this.get("itemWidth");var n=this,r=n.get("children");t.each(r,function(t){t.set("width",e)})},_scrollToItem:function(e){if(this.get("forceFit"))return;var t=this,n=t.getContentElement(),r=n.position(),i=t._getDistanceToEnd(e,n,r),s=t._getDistanceToBegin(e,r);if(n.width()<n.parent().width())t._scrollTo(n,0);else if(s<0)t._scrollTo(n,r.left-s);else if(i>0)t._scrollTo(n,r.left+i*-1);else if(r.left<0){var o=t._getLastDistance(n,r),u=0;o<0&&(u=r.left-o,u=u<0?u:0,t._scrollTo(n,u))}},_getDistanceToBegin:function(e,t){var n=e.get("el").position();return n.left+t.left},_getDistanceToEnd:function(e,t,n){var r=this,t=t||r.getContentElement(),i=t.parent().width(),n=n||t.position(),s=r._getDistanceToBegin(e,n),o=s+r.get("itemWidth")-i;return o},_getLastDistance:function(e,t){var n=this,r=n.get("children"),i=r[r.length-1];return i?n._getDistanceToEnd(i,e,t):0},_scrollTo:function(e,t,n){var r=this;e.animate({left:t},500,function(){r._setArrowStatus(e)})},_scrollLeft:function(){var e=this,t=e.getContentElement(),n=t.position(),r=e._getLastDistance(t,n),i;r>0&&(i=r>e.get("itemWidth")?e.get("itemWidth"):r,e._scrollTo(t,n.left-i))},_scrllRight:function(){var e=this,t=e.getContentElement(),n=t.position(),r;n.left<0&&(r=n.left+e.get("itemWidth"),r=r<0?r:0,e._scrollTo(t,r))},_setArrowStatus:function(e,t){e=e||this.getContentElement();var n=this,r=n.get("el"),i=t||e.position(),u=n._getLastDistance(e,t);i.left<0?r.addClass(o+"-active"):r.removeClass(o+"-active"),u>0?r.addClass(s+"-active"):r.removeClass(s+"-active")},_setItemActived:function(e){var t=this,n=t.getActivedItem();if(e===n)return;n&&n.set("actived",!1),t.set("preItem",n),e&&(e.get("actived")||e.set("actived",!0),e.get("visible")&&t._scrollToItem(e),t.fire("activeChange",{item:e}),t.fire("activedchange",{item:e}))}},{ATTRS:{defaultChildClass:{value:"nav-tab-item"},menu:{},forceFit:{view:!0,value:!1},itemWidth:{value:f},tpl:{view:!0,value:'<div class="tab-nav-bar"><s class="tab-nav-arrow arrow-left"></s><div class="tab-nav-wrapper"><div class="tab-nav-inner"><ul class="'+i+'"></ul></div></div><s class="tab-nav-arrow arrow-right"></s>'+"</div>"+'<div class="tab-content-container"></div>'},xview:{value:l},events:{value:{itemclick:!1,activedchange:!1}}}},{xclass:"nav-tab",priority:0});return c}),define("bui/tab/tabitem",["bui/common"],function(e){var t=e("bui/common"),n=t.Component,r=n.UIBase,i=n.View.extend([r.ListItemView],{},{xclass:"tab-item-view"}),s=n.Controller.extend([r.ListItem],{},{ATTRS:{elTagName:{view:!0,value:"li"},xview:{value:i},tpl:{view:!0,value:'<span class="bui-tab-item-text">{text}</span>'}}},{xclass:"tab-item"});return s.View=i,s}),define("bui/tab/tab",["bui/common"],function(e){var t=e("bui/common"),n=t.Component,r=n.UIBase,i=n.Controller.extend([r.ChildList],{},{ATTRS:{elTagName:{view:!0,value:"ul"},defaultChildClass:{value:"tab-item"}}},{xclass:"tab"});return i}),define("bui/tab/tabpanelitem",["bui/common","bui/tab/tabitem","bui/tab/panelitem"],function(e){var t=e("bui/common"),n=e("bui/tab/tabitem"),r=e("bui/tab/panelitem"),i="bui-tab-item-text",s=t.Component,o=n.View.extend([s.UIBase.Close.View],{_uiSetTitle:function(e){var t=this,n=t.get("el"),r=n.find("."+i);r.text(e)}},{xclass:"tab-panel-item-view"}),u=n.extend([r,s.UIBase.Close],{},{ATTRS:{closeAction:{value:"remove"},title:{view:!0,sync:!1},tpl:{value:'<span class="'+i+'">{text}{title}</span>'},closeable:{value:!1},events:{value:{beforeclosed:!0}},xview:{value:o}}},{xclass:"tab-panel-item"});return u.View=o,u}),define("bui/tab/tabpanel",["bui/common","bui/tab/tab","bui/tab/panels"],function(e){var t=e("bui/common"),n=e("bui/tab/tab"),r=e("bui/tab/panels"),i=n.extend([r],{bindUI:function(){var e=this;e.on("beforeclosed",function(t){var n=t.target;e._beforeClosedItem(n)})},_beforeClosedItem:function(e){if(!e.get("selected"))return;var t=this,n=t.indexOfItem(e),r=t.getItemCount(),i,s;n!==r-1?(s=t.getItemAt(n+1),t.setSelected(s)):n!==0&&(i=t.getItemAt(n-1),t.setSelected(i))}},{ATTRS:{elTagName:{value:"div"},childContainer:{value:"ul"},tpl:{value:'<div class="tab-panel-inner"><ul></ul><div class="tab-panels"></div></div>'},panelTpl:{value:"<div></div>"},panelContainer:{value:".tab-panels"},defaultChildClass:{value:"tab-panel-item"}}},{xclass:"tab-panel"});return i});
