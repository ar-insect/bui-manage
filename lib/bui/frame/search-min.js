define("frame/search",["bui/common","bui/grid","bui/form","bui/data","bui/overlay"],function(a){function b(a){b.superclass.constructor.call(this,a),this._init()}var c=a("bui/common"),d=a("bui/grid"),e=a("bui/data"),f=(a("bui/overlay"),a("bui/form"));return b.ATTRS={autoSearch:{value:!0},gridId:{value:"grid"},formId:{value:"searchForm"},btnId:{value:"btnSearch"},formCfg:{value:{}},gridCfg:{},form:{},grid:{},store:{}},c.extend(b,c.Base),c.augment(b,{_init:function(){var a=this;a._initForm(),a._initStoreEvent(),a._initGrid(),a._initEvent(),a._initData()},_initEvent:function(){this._initDomEvent(),this._initFormEvent(),this._initGridEvent()},_initDomEvent:function(){var a=this,b=a.get("btnId"),c=(a.get("store"),a.get("form"));$("#"+b).on("click",function(b){b.preventDefault(),c.valid(),c.isValid()&&a.load(!0)})},_initForm:function(){var a=this,b=a.get("form");if(!b){var d=c.merge(a.get("formCfg"),{srcNode:"#"+a.get("formId")});b=new f.HForm(d),b.render(),a.set("form",b)}},_initFormEvent:function(){},_initGrid:function(){var a=this,b=a.get("grid");if(!b){var c=a.get("gridCfg"),e=a.get("store");c.store=e,c.render="#"+a.get("gridId"),b=new d.Grid(c),b.render(),a.set("grid",b)}},_initGridEvent:function(){},_initData:function(){var a=this,b=a.get("autoSearch");b&&a.load(!0)},_initStoreEvent:function(){var a=this,b=a.get("store");b.on("exception",function(a){c.Message.Alert(a.error)})},load:function(a){var b=this,c=b.get("form"),d=b.get("store"),e=c.serializeToObject();a&&(e.start=0,e.pageIndex=0),d.load(e)}}),b.createStore=function(a,b){return b=c.merge({autoLoad:!1,url:a,pageSize:30},b),new e.Store(b)},b.createGridCfg=function(a,b){return b=c.merge({columns:a,loadMask:!0,bbar:{pagingBar:!0}},b)},b.createLink=function(a){var b='<span class="page-action grid-command" data-id="{id}" data-href="{href}" title="{title}">{text}</span>';return c.substitute(b,a)},b});